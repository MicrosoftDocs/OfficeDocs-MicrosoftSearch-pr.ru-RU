---
title: Соединитель файлового ресурса для службы поиска Майкрософт
ms.author: v-pamcn
author: TrishaMc1
manager: mnirkhe
ms.audience: Admin
ms.topic: article
ms.service: mssearch
localization_priority: Normal
search.appverid:
- BFB160
- MET150
- MOE150
description: Настройка соединителя файлового ресурса для поиска Майкрософт.
ms.openlocfilehash: 9791ee3460eb174fd7a478baa6a9beb45f1b1aab
ms.sourcegitcommit: 6b531b2ce7253c16251c7089795dedf1d2f3fc33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2019
ms.locfileid: "38310719"
---
# <a name="file-share-connector"></a>Соединитель файлов общего доступа

С помощью соединителя файлового ресурса пользователи организации могут выполнять поиск в локальных файловых ресурсах. Результаты поиска из этих общих файловых ресурсов объединены с результатами из SharePoint и Microsoft OneDrive для бизнеса.

Эта статья предназначена для администраторов Microsoft 365 или пользователей, которые настраивают, запускают и отслеживают файловый соединитель. В этой статье объясняется, как настроить возможности соединителя и соединителя, ограничения и способы устранения неполадок.

## <a name="install-a-data-gateway"></a>Установка Data Gateway
Чтобы получить доступ к данным третьих сторон, необходимо установить и настроить шлюз Microsoft Power BI Gateway. Чтобы узнать больше, ознакомьтесь со статьей [Установка локального шлюза](https://docs.microsoft.com/data-integration/gateway/service-gateway-install) .  

## <a name="content-requirements"></a>Требования к содержимому
**Типы файлов**. Индексировать и искать можно только файлы в этих форматах: DOC, DOCM, DOCX, DOT, DOTX, EML, GIF, HTML, JPEG, MHT, MHTML, MSG, НВС, ОБД, ОБТ, ODP,,, ODP, ODS, PPT, PPTM, PPTX, PPS, PPT, XLC, PPTX, TXT, XLB, Индексируется только текстовое содержимое этих форматов. Весь мультимедийный контент игнорируется.
 
**Предельные размеры файлов**. Максимальный поддерживаемый размер файла составляет 100 МБ. Файлы, размер которых превышает 100 МБ, пропускаются при индексации. Максимально допустимый размер обработки после обработки составляет 4 МБ. Обработка прекратится, когда размер файла достигнет 4 МБ. В результате некоторые фразы, присутствующие в файле, могут не работать для поиска.

## <a name="connect-to-a-data-source"></a>Подключение к источнику данных
На странице **Подключение к источнику данных** выберите **файловый ресурс** и укажите имя, идентификатор подключения и описание. На следующей странице Укажите путь к общему файловому ресурсу и выберите ранее установленный шлюз. Введите учетные данные для учетной записи пользователя Windows с доступом на чтение ко всем файлам в общем ресурсе. Пройдите остальные параметры и опубликуйте подключение.

## <a name="set-the-refresh-schedule"></a>Настройка расписания обновления
Рекомендуемый интервал расписания обновления по умолчанию равен 15 минутам, но его можно изменить на другой предпочтительный интервал.

## <a name="set-up-your-search-results-page"></a>Настройка страницы результатов поиска
Для отображения различных результатов подключения файлов на вкладках " **все** " и " **файлы** " необходимо настроить страницу результатов поисковой системы SharePoint:
- В таблице **ALL** показаны Объединенные результаты из файлов подключения файлов, файлов SharePoint, файлов OneDrive и сайтов SharePoint. 
- На вертикальном **файлов** отображаются все результаты из ваших подключений, SharePoint и OneDrive.
Результаты из файлов подключения добавляются к уже существующим результатам как по вертикали, **так и к** **файлам** .

Чтобы настроить страницу результатов поиска, выполните указанные ниже действия.
1. Создайте семейство веб-сайтов SharePoint с современной страницей поиска.

2. Установите [командную консоль SharePoint Online](https://www.microsoft.com/download/details.aspx?id=35588).

3. Откройте командную консоль SharePoint Online от имени администратора и импортируйте модуль **Microsoft. SharePoint. Client. dll** , `C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Microsoft.SharePoint.Client\v4.0_16.0.0.0__71e9bce111e9429c\Microsoft.SharePoint.Client.dll`расположенный по адресу.

> [!NOTE]
> Этот путь может быть не одинаковым для всех пользователей.

Чтобы импортировать модуль, выполните следующую команду в консоли управления SharePoint Online:
```bash
Import-Module "C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Microsoft.SharePoint.Client\v4.0_16.0.0.0__71e9bce111e9429c\Microsoft.SharePoint.Client.dll" 
```

4. Теперь выполните следующий сценарий:
```bash
$orgName = Read-Host -prompt 'Please enter your org name'
$userName = Read-Host -prompt 'Enter user name'
$userCreds = Get-Credential -UserName $userName -Message "Type the password"
Connect-SPOService -Url https://$orgName-admin.sharepoint.com -Credential $userCreds

$url = Read-Host -Prompt 'Please enter the site url'
$site = Get-SPOSite -Identity $url
Set-SPOSite $url -DenyAddAndCustomizePages 0

$pwd = Read-Host -AsSecureString 'type the password'
$context = New-Object Microsoft.SharePoint.Client.ClientContext($url)
$credential = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($userName, $pwd)
$context.Credentials = $credential
$web = $context.Web
$context.Load($web)
$web.AllProperties["AllVerticalContent"] = "Combined"
$web.Update()
$context.ExecuteQuery()
$web.AllProperties["FilesVerticalContent"] = "ConnectorsOnly"
$web.Update()
$context.ExecuteQuery()
Set-SPOSite $url -DenyAddAndCustomizePages 1

Write-Host "Success" -ForegroundColor Cyan
Read-Host -Prompt 'Press enter to exit'
```

5. Введите необходимые значения в PowerShell, такие как имя Организации, имя пользователя, пароль и URL-адрес сайта. **Например**, если учетные данные администратора указаны `admin@a830edad9050849823J19081300.onmicrosoft.com`, то имя вашей организации — **a830edad9050849823J19081300**, а URL-адрес вашего сайта `https:// a830edad9050849823J19081300.sharepoint.com`—.

> [!NOTE]
> Параметр **аллпропертиес** можно выполнить только на уровне семейства веб-сайтов (на сайте Teams/Dataport).

6. Теперь вы можете искать индексированные файлы и просматривать результаты на вкладках " **все** " и " **файлы** ".

## <a name="search-for-file-share-content-in-the-search-results-page"></a>Поиск содержимого общего файлового ресурса на странице результатов поиска
Чтобы выполнить поиск индексированного контента, перейдите на домашнюю страницу SharePoint тестового клиента. Результаты будут отображаться на вкладках " **все** " и " **файлы** ".

Из-за ограничений браузера невозможно выбрать результат файла для просмотра или открытия файлов из поиска на локальном общем файловом ресурсе. Чтобы открыть эти файлы, скопируйте ссылку результатов файла и вставьте ее в адресную строку браузера системы. Для Windows используйте проводник Windows. После этого вы сможете открыть файл в вашей системе.

![Поиск SharePoint с открытым диалоговым окном "Копировать ссылку".](media/fileshare-search.png)

## <a name="troubleshooting"></a>Устранение неполадок
Если при подключении что-то пошло не так, отображается состояние **Failed**. Чтобы получить дополнительные сведения об ошибках трех типов, перейдите на страницу **сведения об ошибке** и выберите неисправное подключение. Чтобы узнать больше, ознакомьтесь со статьей [Управление соединителем](manage-connector.md) .
1. **Шлюз недостижим (код ошибки: 11)**. Компьютер шлюза для подключения отключен. Проверьте, запущен ли процесс Microsoft Power BI на компьютере шлюза.
2. **Ошибка проверки подлинности (код ошибки: 12)**. Учетные данные, которые использовались для создания подключения, просрочены или больше не являются допустимыми. Чтобы устранить эту ошибку, введите допустимые учетные данные.
3. **Внутренняя ошибка (код ошибки: все, кроме 11 и 12)**. Ошибка в инфраструктуре соединителей. Чтобы узнать, как сообщить об этих ошибках, ознакомьтесь со статьей [обратной связи](connectors-feedback.md) .

## <a name="limitations"></a>Ограничения
В предварительной версии для соединителя файлового ресурса действуют следующие ограничения:
* Индексировать можно только файлы с фиксированными свойствами, а не файлами с настраиваемыми свойствами.
* Списки управления доступом к файловому ресурсу в настоящее время не поддерживаются. Поддерживаются только ACL файловой системы NTFS.
* Внешние удостоверения не поддерживаются. Они должны быть сопоставлены с удостоверениями Azure Active Directory.
